# Diff 策略

1. Web UI 中节点跨级操作特别少，可以忽略不计。
2. 拥有相同类的两个组件将会生成相似的树形结构，拥有不同类的两个组件将会生成不同的树形结构。
3. 对于用一层级的一组子节点，他们可以通过唯一的 key 来区分，以方便后续的列表对比算法。

基于如上，React 分别对 tree diff、Component diff 、element diff 进行了算法优化。

## Tree Diff

基于策略一，React 的 diff 非常简单明了：只会对同一层级的节点进行比较。基于此，React 官方并不推荐进行 DOM 节点的跨层级操作。

## Component Diff

如果是同一类型的组件，按照原策略继续比较 virtual DOM tree。
如果不是，则将该组件判断为 dirty component，从而替换整个组件下的所有子节点。

## Element Diff

对于节点的对比，只有三种操作：插入、移动和删除。

允许开发者对同一层级的同组子节点，添加唯一 key 进行区分，虽然只是小小的改动，性能上却发生了翻天覆地的变化！
